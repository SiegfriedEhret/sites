---
import { getCollection } from "astro:content";
import Layout from "../../../layouts/Layout.astro";
import { formatDate, getYear } from "@packages/utils/date";
import BadidonSubscribe from "../../../components/BadidonSubscribe.astro";
import Responsive from "@packages/ui/Responsive.astro";
import SuperTitle from "@packages/ui/SuperTitle.astro";

const badidon = (await getCollection("badidon"))
  .map((item) => ({
    title: item.data.title,
    slug: item.slug,
    description: item.data.description,
    image: item.data.image,
    date: formatDate(item.data.date),
    tags: item.data.tags,
  }))
  .sort((a, b) => b.date.localeCompare(a.date));
---

<Layout title="/badidon [sieg.fr/ied]" description="🎙️badidon. Un podcast.">
  <SuperTitle title="Badidon." />
  <Responsive>
    <p>Le podcast qui vous fait dire « badidon ». Par Ayako et Siegfried.</p>

    <BadidonSubscribe />

    <h2>Tous les épisodes</h2>

    <nav>
      {
        badidon.map((item) => (
          <section data-year={getYear(item.date)}>
            <h2>
              <a href={`/ied/badidon/${item.slug}`}>
                <span>🎙️</span>
                <span>{item.title}</span>
              </a>
            </h2>
            <div>
              <time datetime={item.date}>{formatDate(item.date)}</time>
            </div>
            <p>{item.description}</p>
          </section>
        ))
      }
    </nav>
  </Responsive>
</Layout>

<style>
  .badidon {
    display: none;
    position: relative;
    width: 500px;
    height: 500px;
    flex-direction: column;
    font-size: 10.5rem;
    line-height: 1;
    color: var(--wevet);
    text-shadow: 0 0 42px var(--paean-black);

    img {
      position: absolute;
      width: 100%;
      height: 100%;
      object-fit: cover;
      aspect-ratio: 1 / 1;
    }
    span {
      z-index: 1;
    }
  }
  time {
    font-variant: tabular-nums;
  }

  li {
    margin: 0;
    padding: 0;
  }

  a {
    display: inline-flex;
    gap: var(--base);
  }

  section {
    margin: 1rem 0;
  }

  section > * {
    margin: 0;
  }

  section[data-year] {
    position: relative;
  }

  section[data-year]::before {
    display: block;
    background: var(--prime);
    color: var(--wevet);
    padding: 0.5rem 1rem;
    font-weight: bold;
    font-variant: tabular-nums;
    border: 2px solid var(--back);
  }

  @media screen and (min-width: 60rem) {
    section[data-year]::before {
      position: absolute;
      right: 0;
      top: 0;
      transform: rotate(-90deg) translateX(-1rem) translateY(-4.5rem);
    }
  }

  section[data-year="2024"]::before {
    content: "2024";
  }
  section[data-year="2023"]::before {
    content: "2023";
  }
  section[data-year="2022"]::before {
    content: "2022";
  }
  section[data-year="2021"]::before {
    content: "2021";
  }
  section[data-year="2020"]::before {
    content: "2020";
  }
  section[data-year="2019"]::before {
    content: "2019";
  }
  section[data-year="2018"]::before {
    content: "2018";
  }
  section[data-year="2017"]::before {
    content: "2017";
  }
  section[data-year="2016"]::before {
    content: "2016";
  }
  section[data-year="2015"]::before {
    content: "2015";
  }
  section[data-year="2014"]::before {
    content: "2014";
  }
  section[data-year="2013"]::before {
    content: "2013";
  }
  section[data-year="2012"]::before {
    content: "2012";
  }
  section[data-year="2011"]::before {
    content: "2011";
  }

  section[data-year="2024"] + section[data-year="2024"]::before,
  section[data-year="2023"] + section[data-year="2023"]::before,
  section[data-year="2022"] + section[data-year="2022"]::before,
  section[data-year="2021"] + section[data-year="2021"]::before,
  section[data-year="2020"] + section[data-year="2020"]::before,
  section[data-year="2019"] + section[data-year="2019"]::before,
  section[data-year="2018"] + section[data-year="2018"]::before,
  section[data-year="2017"] + section[data-year="2017"]::before,
  section[data-year="2016"] + section[data-year="2016"]::before,
  section[data-year="2015"] + section[data-year="2015"]::before,
  section[data-year="2014"] + section[data-year="2014"]::before,
  section[data-year="2013"] + section[data-year="2013"]::before,
  section[data-year="2012"] + section[data-year="2012"]::before,
  section[data-year="2011"] + section[data-year="2011"]::before {
    content: "";
    padding: 0;
    border: 0;
  }
</style>
