---
import { getCollection } from "astro:content";
import Layout from "../layouts/Layout.astro";
import { formatDate } from "@packages/utils/date";

const entriesFromRepository = await getCollection("posts");

const posts = entriesFromRepository.map((item) => ({
  title: item.data.title,
  slug: item.slug,
  description: item.data.description,
  date: formatDate(item.data.date),
}))
  .sort((a, b) => b.date.localeCompare(a.date))
  .slice(0, 10);
---

<Layout title="/ [ehret.me]">
  <article>
    <h1>My name is Siegfried Ehret. I am a developer.</h1>

    <p>Welcome to my website!</p>

    <section>
      <h2>Get them while they're hot, here are the latest publications.</h2>
      <nav>
        {
          posts.map((item) => (
            <section>
              <h3>
                <a href={`/${item.slug}`}>{item.title}</a>
              </h3>
              <div>
                <time datetime={item.date}>{formatDate(item.date)}</time>
              </div>
              <p>{item.description}</p>
            </section>
          ))
        }
      </nav>
      <a href="/notes">All notes.</a>
    </section>

    <section>
      <h2>Some projects.</h2>
      <p>ðŸš§ This section is it progress. ðŸš§</p>
      <dl>
        <dt>
          <a href="https://git.sr.ht/~siegfriedehret/tagzytout"> tagzytout</a>
        </dt>
        <dd>A tool to automate tag creation from git commits.</dd>
      </dl>
    </section>
  </article>
</Layout>

<style>
  section {
    margin: 1rem 0;
  }

  section > * {
    margin: 0;
  }
</style>
